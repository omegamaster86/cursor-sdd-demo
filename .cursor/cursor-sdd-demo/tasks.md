# 実装計画

**成果物の参照**: `.cursor/cursor-sdd-demo/artifacts/feature-list.md` / `.cursor/cursor-sdd-demo/artifacts/data-model.md` / `.cursor/cursor-sdd-demo/artifacts/table-definition.md`

---

## タスク一覧

- [ ] 1. データベース基盤セットアップ
- [ ] 1.1 Prismaスキーマ定義
  - カテゴリ、問題、問題選択肢、ユーザー、回答履歴のモデルを定義
  - 難易度のenum型を定義（easy/medium/hard）
  - 外部キー制約とカスケード設定を実装
  - ユニーク制約（カテゴリ名、メールアドレス）を設定
  - _要件: 1.8, 1.9, 2.7, 5.6_

- [ ] 1.2 マイグレーション実行とシードデータ作成
  - 初期マイグレーションを実行
  - 開発用シードデータ（サンプルカテゴリ・問題・ユーザー）を作成
  - Prisma Clientを生成
  - _要件: 1.2, 2.2, 5.3_

---

- [ ] 2. カテゴリ管理機能
- [ ] 2.1 (P) カテゴリCRUD用Server Actionsを実装
  - カテゴリ一覧取得、詳細取得、作成、更新、削除のアクションを実装
  - 問題が紐づくカテゴリの削除を禁止するバリデーション
  - 入力バリデーションとエラーハンドリング
  - _要件: 5.1, 5.2, 5.3, 5.4, 5.5, 5.6_

- [ ] 2.2 カテゴリ一覧画面を実装
  - カテゴリ一覧をテーブル形式で表示
  - 作成・編集・削除ボタンを配置
  - 削除時の確認ダイアログを実装
  - 問題が存在するカテゴリは削除ボタン無効化またはエラー表示
  - _要件: 5.1, 5.5, 5.6_

- [ ] 2.3 カテゴリ作成・編集フォームを実装
  - カテゴリ名と説明の入力フォーム
  - バリデーションエラーのフィールド単位表示
  - 作成/編集後の一覧へのリダイレクト
  - _要件: 5.2, 5.3, 5.4_

---

- [ ] 3. 問題管理機能
- [ ] 3.1 問題CRUD用Server Actionsを実装
  - 問題一覧取得（ページネーション、フィルタ対応）
  - 問題詳細取得、作成、更新、削除のアクションを実装
  - カテゴリ・難易度によるフィルタリング
  - キーワード検索（タイトル・本文）
  - 入力バリデーションとエラーハンドリング
  - _要件: 1.2, 1.4, 1.6, 1.7, 3.1, 3.2, 3.3, 6.1, 6.2, 6.3, 6.4, 6.5_

- [ ] 3.2 問題一覧画面を実装
  - 問題ID・タイトル・カテゴリ・難易度・作成日時・更新日時を表示
  - ページネーション機能
  - 問題詳細・編集画面へのリンク
  - 削除ボタンと確認ダイアログ
  - _要件: 1.3, 1.5, 1.6, 3.1, 3.2, 3.3_

- [ ] 3.3 問題検索・フィルタ機能を実装
  - キーワード検索フィールド
  - カテゴリ選択フィルタ
  - 難易度選択フィルタ
  - 複数フィルタの組み合わせ
  - フィルタクリア機能
  - URL検索パラメータで状態管理
  - _要件: 6.1, 6.2, 6.3, 6.4, 6.5_

- [ ] 3.4 問題作成画面を実装
  - タイトル・本文・カテゴリ・難易度の入力フォーム
  - カテゴリはセレクトボックスで選択
  - 難易度は初級/中級/上級から選択
  - バリデーションエラーのフィールド単位表示
  - 作成後の一覧へのリダイレクト
  - _要件: 1.1, 1.2, 1.7, 1.8, 1.9_

- [ ] 3.5 問題編集画面を実装
  - 既存問題データの読み込みと表示
  - タイトル・本文・カテゴリ・難易度の編集
  - バリデーションエラーのフィールド単位表示
  - 更新後の一覧へのリダイレクト
  - _要件: 1.3, 1.4, 1.7, 1.8, 1.9_

---

- [ ] 4. ユーザー管理機能
- [ ] 4.1 (P) ユーザーCRUD用Server Actionsを実装
  - ユーザー一覧取得（ページネーション対応）
  - ユーザー詳細取得、登録、更新、削除のアクションを実装
  - メールアドレス重複チェック
  - 入力バリデーションとエラーハンドリング
  - _要件: 2.2, 2.4, 2.6, 2.7, 2.8, 4.1, 4.2, 4.3_

- [ ] 4.2 ユーザー一覧画面を実装
  - ユーザーID・名前・メールアドレス・登録日時を表示
  - ページネーション機能
  - ユーザー詳細・編集画面へのリンク
  - 削除ボタンと確認ダイアログ
  - _要件: 2.3, 2.5, 2.6, 4.1, 4.2, 4.3_

- [ ] 4.3 ユーザー登録画面を実装
  - 名前・メールアドレスの入力フォーム
  - メールアドレス重複エラーの表示
  - バリデーションエラーのフィールド単位表示
  - 登録後の一覧へのリダイレクト
  - _要件: 2.1, 2.2, 2.7, 2.8_

- [ ] 4.4 ユーザー編集画面を実装
  - 既存ユーザーデータの読み込みと表示
  - 名前・メールアドレスの編集
  - メールアドレス重複エラーの表示
  - バリデーションエラーのフィールド単位表示
  - 更新後の一覧へのリダイレクト
  - _要件: 2.3, 2.4, 2.7, 2.8_

---

- [ ] 5. 共通UIコンポーネントとレイアウト
- [ ] 5.1 (P) 管理画面レイアウトとナビゲーションを実装
  - サイドバーまたはヘッダーナビゲーション
  - 問題管理・ユーザー管理・カテゴリ管理へのリンク
  - レスポンシブ対応
  - _要件: 3.1, 4.1, 5.1_

- [ ] 5.2 (P) 共通UIコンポーネントを実装
  - ページネーションコンポーネント
  - 確認ダイアログコンポーネント
  - フォームフィールドコンポーネント（入力、セレクト、エラー表示）
  - テーブルコンポーネント
  - _要件: 1.5, 1.6, 2.5, 2.6, 3.3, 4.3_

---

- [ ] 6. 統合とルーティング
- [ ] 6.1 App Routerのルート構成を実装
  - `/questions` - 問題一覧
  - `/questions/new` - 問題作成
  - `/questions/[id]/edit` - 問題編集
  - `/users` - ユーザー一覧
  - `/users/new` - ユーザー登録
  - `/users/[id]/edit` - ユーザー編集
  - `/categories` - カテゴリ一覧
  - _要件: 1.1, 1.3, 2.1, 2.3, 5.1_

- [ ] 6.2 エラーハンドリングとローディング状態を実装
  - `error.tsx` によるエラーバウンダリ
  - `loading.tsx` によるローディング表示
  - `not-found.tsx` による404ページ
  - _要件: 1.7, 2.7, 2.8_

- [ ] 6.3 全機能の統合テストと動作確認
  - 問題CRUD操作フローの確認
  - ユーザーCRUD操作フローの確認
  - カテゴリCRUD操作フローの確認
  - 検索・フィルタ機能の確認
  - エラーハンドリングの確認
  - _要件: 1.1-1.9, 2.1-2.8, 3.1-3.3, 4.1-4.3, 5.1-5.6, 6.1-6.5_

---

## 要件カバレッジマトリクス

| 要件 | タスク |
|------|--------|
| 1.1 | 3.4, 6.1 |
| 1.2 | 1.2, 3.1, 3.4 |
| 1.3 | 3.2, 6.1 |
| 1.4 | 3.1, 3.5 |
| 1.5 | 3.2, 5.2 |
| 1.6 | 3.1, 3.2, 5.2 |
| 1.7 | 3.1, 3.4, 3.5, 6.2 |
| 1.8 | 1.1, 3.4, 3.5 |
| 1.9 | 1.1, 3.4, 3.5 |
| 2.1 | 4.3, 6.1 |
| 2.2 | 1.2, 4.1, 4.3 |
| 2.3 | 4.2, 4.4, 6.1 |
| 2.4 | 4.1, 4.4 |
| 2.5 | 4.2, 5.2 |
| 2.6 | 4.1, 4.2, 5.2 |
| 2.7 | 1.1, 4.1, 4.3, 4.4, 6.2 |
| 2.8 | 4.1, 4.3, 4.4, 6.2 |
| 3.1 | 3.1, 3.2, 5.1 |
| 3.2 | 3.1, 3.2 |
| 3.3 | 3.1, 3.2, 5.2 |
| 4.1 | 4.1, 4.2, 5.1 |
| 4.2 | 4.1, 4.2 |
| 4.3 | 4.1, 4.2, 5.2 |
| 5.1 | 2.1, 2.2, 5.1, 6.1 |
| 5.2 | 2.1, 2.3 |
| 5.3 | 1.2, 2.1, 2.3 |
| 5.4 | 2.1, 2.3 |
| 5.5 | 2.1, 2.2 |
| 5.6 | 1.1, 2.1, 2.2 |
| 6.1 | 3.1, 3.3 |
| 6.2 | 3.1, 3.3 |
| 6.3 | 3.1, 3.3 |
| 6.4 | 3.1, 3.3 |
| 6.5 | 3.1, 3.3 |

---

## 変更履歴

| 日付 | バージョン | 変更者 | 変更内容 |
| ---- | ---------- | ------ | -------- |
| 2024/12/23 | v1.0 | - | 初版作成 |
