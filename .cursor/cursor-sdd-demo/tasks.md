# 実装計画

**成果物参照**: `.cursor/cursor-sdd-demo/artifacts/feature-list.md` / `data-model.md` / `table-definition.md`

---

## タスク一覧

- [ ] 1. プロジェクト基盤セットアップ
- [ ] 1.1 Prisma と PostgreSQL の設定
  - Prisma をインストールし、初期設定を行う
  - PostgreSQL 接続設定を環境変数で管理
  - 開発用データベースを準備
  - _要件: 全般_

- [ ] 1.2 データベーススキーマを定義
  - Survey, Question, QuestionOption テーブルを作成
  - Response, Answer テーブルを作成
  - Notice テーブルを作成
  - マイグレーションを実行
  - _要件: 全般_

- [ ] 1.3 (P) 共通型定義とユーティリティを作成
  - API レスポンス型を定義
  - エラーハンドリングユーティリティを作成
  - _要件: 全般_

---

- [ ] 2. アンケート管理機能
- [ ] 2.1 アンケート一覧 API を実装
  - GET /api/surveys エンドポイントを作成
  - アンケート一覧と回答数を取得するクエリを実装
  - _要件: 1.1, 1.2_
  - _Contracts: SurveyService.list_

- [ ] 2.2 アンケート一覧画面を実装
  - アンケート一覧ページを作成
  - タイトル、作成日時、回答数を表形式で表示
  - 新規作成ボタンを配置
  - アンケートクリックで編集画面へ遷移
  - _要件: 1.1, 1.2, 1.3_

- [ ] 2.3 アンケート作成・取得 API を実装
  - POST /api/surveys エンドポイントを作成
  - GET /api/surveys/:id エンドポイントを作成
  - アンケートと質問を一括で保存するロジックを実装
  - _要件: 2.1, 2.4, 2.5_
  - _Contracts: SurveyService.create, SurveyService.get_

- [ ] 2.4 アンケート更新 API を実装
  - PUT /api/surveys/:id エンドポイントを作成
  - 質問の追加・更新・削除を処理
  - _要件: 2.4, 2.5_
  - _Contracts: SurveyService.update_

- [ ] 2.5 アンケート作成画面を実装
  - アンケート作成フォームを作成
  - タイトル、説明の入力欄を配置
  - 質問追加機能を実装（質問タイプ選択、質問文入力）
  - 選択肢入力機能を実装（単一選択・複数選択用）
  - 保存ボタンで API を呼び出し
  - _要件: 2.1, 2.2, 2.3, 2.4_

- [ ] 2.6 アンケート編集画面を実装
  - 既存アンケートのデータを取得してフォームに表示
  - 質問の編集・追加・削除を可能にする
  - 更新 API を呼び出して保存
  - _要件: 2.5_

---

- [ ] 3. 回答結果表示機能
- [ ] 3.1 (P) 回答一覧 API を実装
  - GET /api/surveys/:id/responses エンドポイントを作成
  - 回答者一覧と回答数を取得
  - _要件: 3.1, 3.2, 3.3_
  - _Contracts: ResponseService.list_

- [ ] 3.2 (P) 回答詳細 API を実装
  - GET /api/surveys/:id/responses/:rid エンドポイントを作成
  - 個別回答の全内容を取得
  - _要件: 3.4_
  - _Contracts: ResponseService.get_

- [ ] 3.3 回答結果一覧画面を実装
  - 回答者一覧ページを作成
  - 回答者数（何人答えたか）を表示
  - 各回答者の回答日時を表示
  - 回答者クリックで詳細画面へ遷移
  - _要件: 3.1, 3.2, 3.3_

- [ ] 3.4 回答詳細画面を実装
  - 個別回答者の回答内容を表示
  - 質問ごとに回答を表示（選択肢または自由記述）
  - _要件: 3.4_

---

- [ ] 4. お知らせ管理機能
- [ ] 4.1 (P) お知らせ一覧 API を実装
  - GET /api/notices エンドポイントを作成
  - お知らせ一覧を取得
  - _要件: 4.1, 4.2_
  - _Contracts: NoticeService.list_

- [ ] 4.2 (P) お知らせ作成・取得・更新 API を実装
  - POST /api/notices エンドポイントを作成
  - GET /api/notices/:id エンドポイントを作成
  - PUT /api/notices/:id エンドポイントを作成
  - _要件: 5.1, 5.3, 5.4_
  - _Contracts: NoticeService.create, NoticeService.get, NoticeService.update_

- [ ] 4.3 お知らせ一覧画面を実装
  - お知らせ一覧ページを作成
  - タイトル、公開日時、公開状態を表形式で表示
  - 新規作成ボタンを配置
  - お知らせクリックで編集画面へ遷移
  - _要件: 4.1, 4.2, 4.3_

- [ ] 4.4 お知らせ作成・編集画面を実装
  - お知らせ作成フォームを作成
  - タイトル、本文、公開日時の入力欄を配置
  - 公開状態のトグルを配置
  - 新規作成と編集の両方に対応
  - _要件: 5.1, 5.2, 5.3, 5.4_

---

- [ ] 5. ナビゲーションと統合
- [ ] 5.1 共通レイアウトとナビゲーションを作成
  - サイドバーまたはヘッダーナビゲーションを実装
  - アンケート一覧、お知らせ一覧へのリンクを配置
  - _要件: 1.1, 4.1_

- [ ] 5.2 全体の動作確認と調整
  - 各画面間の遷移を確認
  - エラーハンドリングの動作を確認
  - UI の一貫性を調整
  - _要件: 全般_

---

## 要件カバレッジ

| 要件 | タスク |
|------|--------|
| 1.1, 1.2, 1.3 | 2.1, 2.2 |
| 2.1, 2.2, 2.3, 2.4, 2.5 | 2.3, 2.4, 2.5, 2.6 |
| 3.1, 3.2, 3.3, 3.4 | 3.1, 3.2, 3.3, 3.4 |
| 4.1, 4.2, 4.3 | 4.1, 4.3 |
| 5.1, 5.2, 5.3, 5.4 | 4.2, 4.4 |

---

## 変更履歴

| 日付 | バージョン | 変更者 | 変更内容 |
| ---- | ---------- | ------ | -------- |
| 2024-12-21 | v1.0 | | 初版作成 |
